## 正则表达式

### 介绍

一种用来检查和匹配字符串的模式的文本表达式语言

### 常用工具

- 在线测试正则表达式网站 
    - [regex101.com](https://regex101.com/)
    - [tool.oschina.net/regex](https://tool.oschina.net/regex)


- 本地 vscode 中 
    - ctrl + f 打开搜索 右边的图标(小方块右上角有个星号) 点亮即为正则表达式模式
    - 插件: Regex Previewer 安装好之后可以像预览md一样预览匹配的内容

### 语法

### 基本字符匹配(Basic)
- `.` 匹配任意字符 除了换行符之外
- `[]` 匹配字符集 
    - 匹配方括号内的任意一个字符。例如，[abc] 会匹配"a", "b", 或 "c"。
    - 可以使用 - 表示范围，例如，[a-z] 就表示所有小写字母。
- `[^]` 匹配非字符集
    - 匹配不在方括号中的任意字符。例如，[^abc]表示非"a", "b", "c"的任
意字符
- `|` 匹配或
    - 逻辑或操作, 例如，cat|dog匹配"cat"或"dog"

### 量词(Quantifiers)

- `*` 匹配0次或者多次前面的元素
- `+` 匹配1次或者多次前面的元素
- `?` 匹配0次或者1次前面的元素
- `{n}` 匹配n次前面的元素
- `{n,}` 匹配n次或者更多次前面的元素
- `{n,m}` 匹配n到m次前面的元素

### 字符类(Character Classes)

- `\d` 匹配任意数字，等价于 [0-9]
- `\D` 匹配任意非数字字符，等价于 [^0-9]
- `\w` 匹配任意字母、数字或下划线，等价于 [A-Za-z0-9_]
- `\W` 匹配任意非字母、数字或下划线字符，等价于 [^A-Za-z0-9_]
- `\s` 匹配任意空白字符，(空格 Tab 换行符等) 等价于 [ \f\n\r\t\v]
- `\S` 匹配任意非空白字符，(空格 Tab 换行符等) 等价于 [^ \f\n\r\t\v]

### 定位符(Anchors)

- `^` 匹配行首 每行的开头 例如 `^Hello` 匹配以**Hello**开始的行
- `$` 匹配行尾 每行的结尾 例如 `World$` 匹配以**World**结尾的行
- `\b` 匹配单词边界 例如 `\bin\b` 就会精确匹配bin单词**in** 而不会匹配find中的**in**
- `\B` 匹配非单词边界 例如 `\Bin\b` 就会匹配find中的**in** 而不会精确匹配bin

### 贪婪匹配和非贪婪匹配

- 默认情况下，正则表达式是贪婪匹配的，也就是匹配尽可能多的字符。

- `?` 后缀表示非贪婪匹配，也就是匹配尽可能少的字符。

- `ab{3,}` 
    - 默认贪婪匹配，只要后面的字符依然满足条件，就会继续匹配。
    - abbb、abbbb、abbbbb、abbbbbb都满足要求。

- `ab{3,}?`
    - 在量词后面加上问号就表示非贪婪匹配，满足条件之后，即使后面
    - 依然符合条件也不会再继续匹配了。只有abbb满足要求，
    - abbbb、abbbbb、abbbbbb就只有前面的部分满足要求。

### 旗标(Flags)

- `i` case insensitive 忽略大小写
- `m` multi-line 多行模式 
- `s` 精确匹配 允许匹配包括换行符在内的所有字符
- `g` global 全局匹配 匹配文本中的所有实例

### 分组和引用(Groups and Backreferences)

- `( )` 分组 用于分隔表达式，提取子表达式

- `(abc)`
    - 捕获分组。可以将多个字符当做一个整体来处理，也可以在后面引用捕获到的分组内容。
    - 例如：想要匹配2024-05-01这样的日期格式，就可以使用：
        - (\d{4})-(\d{1,2})-(\d{1-2})
        - `\n` 引用捕获到的分组内容。例如，`\1` 引用第一个捕获分组的内容。
        - 来分别捕获年、月和日的值，后面也可以使用 \1 、\2 和 \3 或者 $1 、 $2 、$3 来引用它们。

`(?:abc)`
    - 非捕获分组，仅使用分组功能，而不捕获。后面也不可以使用\1或者$1来引用。

### 前瞻(Lookahead)

- `(?=...)` 正向前瞻(Positive Lookahead)
    - 只有当后面分组中的匹配成立时, 才会匹配到它前面的指定内容
    - 例如: `cat(?=dog)` 只有当cat后面紧跟着dog时，才会匹配到cat
    - 例如：`(?=dog)cat` 只有当cat前面紧跟着dog时，才会匹配到cat

- `(?!...)` 负向前瞻(Negative Lookahead)
    - 只有当后面分组中的匹配不成立时, 才会匹配到它前面的指定内容
    - 例如: `cat(?!dog)` 只有当cat后面不紧跟着dog时，才会匹配到cat 比如catcow

### 后顾(Lookbehind)

- `(?<=...)` 正向后顾 (Positive Lookbehind)
    - 只有当前面分组中的匹配成立时, 才会匹配到它后面的指定内容
    - 例如: `(?<=cat)dog` 会匹配catdog中的dog, 但是不会匹配cowdog中的dog

- `(?!...)` 负向后顾 (Negative Lookbehind)
    - 只有当前面分组中的匹配不成立时, 才会匹配到它后面的指定内容
    - 例如: `(?<!cat)dog` 不会匹配到catdog中的dog 但是会匹配到cowdog中的dog


### 常用验证模式

#### 邮件(Email Validation)

`^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$`

- 拆分解析
    - `^` 匹配字符串开头
    - `[A-Za-z0-9._%+-]+` 匹配用户名，可以包含字母、数字、点、下划线、百分号、加号、减号
        - 结尾加号表示用户名可以出现一次或多次
    - `@` 匹配@符号
    - `[A-Za-z0-9.-]+` 匹配域名，可以包含字母、数字、点
        - 结尾加号表示域名可以出现一次或多次
    - `\.` 匹配点号
    - `[A-Za-z]{2,}` 匹配域名后缀，可以包含字母、数字
    - `$` 匹配字符串结尾

#### 网址(URL Validation)

`^(https?:\/\/)?([a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,5})(:[0-9]{1,5})?(\/.*)?$`

- 拆分解析
    - `^` 匹配字符串开头
    - `https?:\/\/` 匹配协议
    - `([a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,5})` 匹配域名
    - `(:[0-9]{1,5})?` 匹配端口号
    - `(/.*)?$` 匹配字符串结尾

#### 金额(Numeric Input Validation)

`^\d+(?:\.\d+)?$`

- 拆分解析
    - `^` 匹配字符串开头
    - `\d+` 匹配数字
    - `(?:\.\d+)?$` 匹配小数

#### 日期(Date Validation)(YYYY-MM-DD)

`^(?:19|20)\d\d-(?:0[1-9]|1[0-2])-(?:0[1-9]|[12][0-9]|3[01])$`

- 拆分解析
    - `^` 匹配字符串开头
    - `(?:19|20)\d\d` 匹配年份
        - `(?:19|20)` 表示可以匹配19或20
        - `\d\d` 表示匹配两位数字
    - `-(?:0[1-9]|1[0-2])` 匹配月份
    - `-(?:0[1-9]|[12][0-9]|3[01])$` 匹配日期

#### 时间(Time Validation)(HH:MM AM/PM)

`^(1[0-2]|0?[1-9]):[0-5][0-9] (AM|PM)$`

- 拆分解析
    - `^` 匹配字符串开头
    - `1[0-2]|0?[1-9]` 匹配小时
    - `:` 匹配冒号
    - `[0-5][0-9]` 匹配分钟
    - `(AM|PM)$` 匹配上下午

#### 电话(Phone Number Validation)

`^\+?[1-9]\d{1,14}$`

- 拆分解析
    - `^` 匹配字符串开头
    - `\+?[1-9]` 匹配国家码
    - `\d{1,14}$` 匹配电话号码

#### 密码强度(Password Strength Validation)

`^(?=.*[A-Z])(?=.*[a-z])(?=.*\d)(?=.*[^\w\s]).{8,}$`

- 拆分解析
    - `^` 匹配字符串开头
    - `(?=.*[A-Z])` 匹配大写字母
    - `(?=.*[a-z])` 匹配小写字母
    - `(?=.*\d)` 匹配数字
    - `(?=.*[^\w\s])` 匹配特殊字符
    - `.{8,}` 匹配长度
    - `$` 匹配字符串结尾

#### 文件拓展名(File Extension Validation)

`^.+\.(jpg|jpeg|png|gif|pdf)$`

- 拆分解析
    - `^` 匹配字符串开头
    - `.+` 匹配文件名
    - `\.jpg|jpeg|png|gif|pdf` 匹配文件拓展名
    - `$` 匹配字符串结尾

#### IP地址(IP Address Validation)

`^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$`

- 拆分解析
    - `^` 匹配字符串开头
    - `(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$` 匹配IP地址
    - `$` 匹配字符串结尾